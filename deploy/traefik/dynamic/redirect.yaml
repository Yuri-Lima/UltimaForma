http:
  middlewares:
    redirect-to-https:
      redirectScheme:
        scheme: https
        permanent: true

  services:
    # Dummy service for redirect-only router (middleware handles response; service never called)
    noop:
      loadBalancer:
        servers:
          - url: "http://127.0.0.1:65535"

  routers:
    http-to-https:
      rule: "HostRegexp(`{host:.+}`) && !PathPrefix(`/.well-known/acme-challenge/`)"
      middlewares:
        - redirect-to-https
      entryPoints:
        - web
      priority: 1
      service: noop
